<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learning Materials Viewer</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='50' fill='%23dc2626'/></svg>">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            height: 100vh;
            overflow: hidden;
            background: #f5f7fa;
        }

        .container { display: flex; height: 100vh; }

        /* â”€â”€ Sidebar â”€â”€ */
        .sidebar {
            width: 300px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            flex-direction: column;
            transition: margin-left 0.3s ease;
            box-shadow: 2px 0 10px rgba(0,0,0,0.15);
            flex-shrink: 0;
        }
        .sidebar.hidden { margin-left: -300px; }

        .sidebar-header {
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .sidebar-header h1 { font-size: 1.4em; margin-bottom: 4px; }
        .sidebar-header p  { font-size: 0.85em; opacity: 0.85; }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
        }

        /* â”€â”€ Nav rows â”€â”€ */
        .nav-folder   { margin-bottom: 10px; }

        .nav-folder-title, .nav-sub-title {
            padding: 10px 14px;
            border-radius: 7px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
            user-select: none;
        }
        .nav-folder-title {
            background: rgba(255,255,255,0.15);
            font-size: 0.97em;
        }
        .nav-folder-title:hover { background: rgba(255,255,255,0.25); }

        .nav-sub-title {
            background: rgba(255,255,255,0.09);
            font-size: 0.9em;
            margin-top: 5px;
        }
        .nav-sub-title:hover { background: rgba(255,255,255,0.18); }

        .arrow {
            margin-left: auto;
            font-size: 0.75em;
            transition: transform 0.25s;
        }
        .collapsed .arrow { transform: rotate(-90deg); }

        .nav-children, .nav-files {
            margin-top: 5px;
            margin-left: 14px;
            display: none;
        }
        .nav-children.open, .nav-files.open { display: block; }

        .nav-file {
            padding: 6px 10px;
            background: rgba(255,255,255,0.05);
            border-radius: 4px;
            margin-bottom: 3px;
            cursor: pointer;
            font-size: 0.88em;
            display: flex;
            align-items: center;
            gap: 7px;
            transition: background 0.2s, transform 0.15s;
        }
        .nav-file:hover  { background: rgba(255,255,255,0.15); transform: translateX(3px); }
        .nav-file.active { background: rgba(255,255,255,0.3); font-weight: 600; }
        .nav-file .file-name { flex: 1; }

        /* â”€â”€ Main â”€â”€ */
        .main-content { flex: 1; display: flex; flex-direction: column; position: relative; min-width: 0; }

        .toggle-btn {
            position: absolute;
            top: 16px; left: 16px;
            z-index: 100;
            padding: 10px 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: all 0.25s;
        }
        .toggle-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(0,0,0,0.2); }

        .welcome-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e9f2 100%);
            text-align: center;
            padding: 40px;
        }
        .welcome-screen .icon-large { font-size: 5em; margin-bottom: 20px; opacity: 0.25; }
        .welcome-screen h2 { font-size: 2.2em; color: #2d3748; margin-bottom: 10px; }
        .welcome-screen p  { font-size: 1.1em; color: #718096; }

        .content-frame { width: 100%; height: 100%; border: none; background: white; }

        /* â”€â”€ Scrollbar â”€â”€ */
        .sidebar-content::-webkit-scrollbar { width: 6px; }
        .sidebar-content::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
        .sidebar-content::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }

        .loading { text-align: center; padding: 40px; opacity: 0.8; }
        .error   { text-align: center; padding: 30px; color: #fca5a5; font-size: 0.9em; }
    </style>
</head>
<body>
<div class="container">

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h1>ğŸ“š Learning Materials</h1>
            <p>Select a document to view</p>
        </div>
        <div class="sidebar-content" id="nav-content">
            <div class="loading">Loadingâ€¦</div>
        </div>
    </div>

    <div class="main-content">
        <button class="toggle-btn" onclick="toggleSidebar()">â˜°</button>

        <div class="welcome-screen" id="welcomeScreen">
            <div class="icon-large">ğŸ“„</div>
            <h2>Welcome!</h2>
            <p>Select a document from the sidebar to begin</p>
        </div>

        <iframe class="content-frame" id="contentFrame" style="display:none;"></iframe>
    </div>
</div>

<script>
// â”€â”€ helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function el(tag, cls, html) {
    const d = document.createElement(tag);
    if (cls)  d.className = cls;
    if (html) d.innerHTML = html;
    return d;
}

function toggleSection(contentEl, titleEl) {
    const open = contentEl.classList.toggle('open');
    titleEl.classList.toggle('collapsed', !open);
}

function loadFile(file, fileEl) {
    document.querySelectorAll('.nav-file').forEach(e => e.classList.remove('active'));
    fileEl.classList.add('active');
    const frame = document.getElementById('contentFrame');
    frame.src = file.html;
    frame.style.display = 'block';
    document.getElementById('welcomeScreen').style.display = 'none';
}

function toggleSidebar() {
    document.getElementById('sidebar').classList.toggle('hidden');
}

// â”€â”€ file element â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function makeFileEl(file) {
    const d = el('div', 'nav-file');
    d.innerHTML = `<span>ğŸ“„</span><span class="file-name">${file.name}</span>`;
    d.onclick = () => loadFile(file, d);
    return d;
}

// â”€â”€ files list â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function makeFilesContainer(files, id) {
    const wrap = el('div', 'nav-files open');
    wrap.id = id;
    files.forEach(f => wrap.appendChild(makeFileEl(f)));
    return wrap;
}

// â”€â”€ subfolder row â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function makeSubFolder(sub, id) {
    const wrap = el('div');

    const title = el('div', 'nav-sub-title',
        `<span>ğŸ“‚</span><span>${sub.name}</span><span class="arrow">â–¼</span>`);

    const filesWrap = makeFilesContainer(sub.files, id);

    title.onclick = () => toggleSection(filesWrap, title);
    wrap.appendChild(title);
    wrap.appendChild(filesWrap);
    return wrap;
}

// â”€â”€ render â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderNavigation(data) {
    const container = document.getElementById('nav-content');
    container.innerHTML = '';

    if (!data.length) {
        container.innerHTML = '<div class="error">No folders found in index.json</div>';
        return;
    }

    data.forEach((folder, fi) => {
        const wrap = el('div', 'nav-folder');

        const title = el('div', 'nav-folder-title',
            `<span>ğŸ“</span><span>${folder.name}</span><span class="arrow">â–¼</span>`);

        const children = el('div', 'nav-children open');
        children.id = `folder-${fi}`;

        // Direct files inside this folder
        if (folder.files && folder.files.length) {
            folder.files.forEach(f => children.appendChild(makeFileEl(f)));
        }

        // Subfolders
        if (folder.subfolders && folder.subfolders.length) {
            folder.subfolders.forEach((sub, si) => {
                children.appendChild(makeSubFolder(sub, `sub-${fi}-${si}`));
            });
        }

        title.onclick = () => toggleSection(children, title);
        wrap.appendChild(title);
        wrap.appendChild(children);
        container.appendChild(wrap);
    });
}

// â”€â”€ init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadIndex() {
    try {
        const res = await fetch('index.json?v=' + Date.now());
        if (!res.ok) throw new Error('index.json not found');
        renderNavigation(await res.json());
    } catch (e) {
        document.getElementById('nav-content').innerHTML =
            `<div class="error">âŒ ${e.message}<br><br>Run sync.ps1 to generate index.json</div>`;
    }
}

loadIndex();
</script>
</body>
</html>